\hypertarget{classklyqa__ctl_1_1account__control_1_1AccountControl}{}\doxysection{klyqa\+\_\+ctl.\+account\+\_\+control.\+Account\+Control Class Reference}
\label{classklyqa__ctl_1_1account__control_1_1AccountControl}\index{klyqa\_ctl.account\_control.AccountControl@{klyqa\_ctl.account\_control.AccountControl}}


Collaboration diagram for klyqa\+\_\+ctl.\+account\+\_\+control.\+Account\+Control\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=307pt]{classklyqa__ctl_1_1account__control_1_1AccountControl__coll__graph}
\end{center}
\end{figure}
\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
None \mbox{\hyperlink{classklyqa__ctl_1_1account__control_1_1AccountControl_a5b4b4e18362cea70b456d2ffc78467a3}{\+\_\+\+\_\+init\+\_\+\+\_\+}} (self, devices, \mbox{\hyperlink{classklyqa__ctl_1_1account_1_1Account}{Account}} account, Cloud\+Backend cloud\+\_\+backend, Local\+Communication local\+\_\+communicator, bool interactive\+\_\+prompts)
\item 
bool \mbox{\hyperlink{classklyqa__ctl_1_1account__control_1_1AccountControl_a2d4985456f595ebe24598fd360d19bae}{request\+\_\+account\+\_\+settings\+\_\+eco}} (self, int scan\+\_\+interval=60)
\item 
None \mbox{\hyperlink{classklyqa__ctl_1_1account__control_1_1AccountControl_ab038bdf3bd58106dd61718ed6bb2625c}{request\+\_\+account\+\_\+settings}} (self)
\item 
bool \mbox{\hyperlink{classklyqa__ctl_1_1account__control_1_1AccountControl_abec04a28ae718f252e846b0c05645e65}{login\+\_\+cache}} (self)
\item 
bool \mbox{\hyperlink{classklyqa__ctl_1_1account__control_1_1AccountControl_a8938cb44ea82c6687990f061dd99828e}{backend\+\_\+connected}} (self)
\item 
None \mbox{\hyperlink{classklyqa__ctl_1_1account__control_1_1AccountControl_a46d51f33622ad0e952a66d0d1b91eb12}{update\+\_\+device\+\_\+configs}} (self)
\item 
None \mbox{\hyperlink{classklyqa__ctl_1_1account__control_1_1AccountControl_afa68c76beee57c491239d9184cd32167}{load\+\_\+username\+\_\+cache}} (self)
\item 
None \mbox{\hyperlink{classklyqa__ctl_1_1account__control_1_1AccountControl_a6f7cdf57ee8b48970fe2554d7c1b9694}{shutdown}} (self)
\end{DoxyCompactItemize}
\doxysubsection*{Public Attributes}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classklyqa__ctl_1_1account__control_1_1AccountControl_a08b89c3d1c25eb8e2e4a58151703d26e}{acc\+\_\+settings}}
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
\begin{DoxyVerb}Account control\end{DoxyVerb}
 

\doxysubsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{classklyqa__ctl_1_1account__control_1_1AccountControl_a5b4b4e18362cea70b456d2ffc78467a3}\label{classklyqa__ctl_1_1account__control_1_1AccountControl_a5b4b4e18362cea70b456d2ffc78467a3}} 
\index{klyqa\_ctl.account\_control.AccountControl@{klyqa\_ctl.account\_control.AccountControl}!\_\_init\_\_@{\_\_init\_\_}}
\index{\_\_init\_\_@{\_\_init\_\_}!klyqa\_ctl.account\_control.AccountControl@{klyqa\_ctl.account\_control.AccountControl}}
\doxysubsubsection{\texorpdfstring{\_\_init\_\_()}{\_\_init\_\_()}}
{\footnotesize\ttfamily  None klyqa\+\_\+ctl.\+account\+\_\+control.\+Account\+Control.\+\_\+\+\_\+init\+\_\+\+\_\+ (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{devices,  }\item[{\mbox{\hyperlink{classklyqa__ctl_1_1account_1_1Account}{Account}}}]{account,  }\item[{Cloud\+Backend}]{cloud\+\_\+backend,  }\item[{Local\+Communication}]{local\+\_\+communicator,  }\item[{bool}]{interactive\+\_\+prompts }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{28     ) -\/> \textcolor{keywordtype}{None}:}
\DoxyCodeLine{29         \textcolor{comment}{\# self.offline = offline}}
\DoxyCodeLine{30         self.devices: dict[str, KlyqaDevice] = devices}
\DoxyCodeLine{31         self.account: Account = account}
\DoxyCodeLine{32         self.cloud\_backend: CloudBackend = cloud\_backend}
\DoxyCodeLine{33         self.local\_communicator: LocalCommunication = local\_communicator}
\DoxyCodeLine{34         self.interactive\_prompts: bool = interactive\_prompts}
\DoxyCodeLine{35 }

\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classklyqa__ctl_1_1account__control_1_1AccountControl_a5b4b4e18362cea70b456d2ffc78467a3_cgraph}
\end{center}
\end{figure}


\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{classklyqa__ctl_1_1account__control_1_1AccountControl_a8938cb44ea82c6687990f061dd99828e}\label{classklyqa__ctl_1_1account__control_1_1AccountControl_a8938cb44ea82c6687990f061dd99828e}} 
\index{klyqa\_ctl.account\_control.AccountControl@{klyqa\_ctl.account\_control.AccountControl}!backend\_connected@{backend\_connected}}
\index{backend\_connected@{backend\_connected}!klyqa\_ctl.account\_control.AccountControl@{klyqa\_ctl.account\_control.AccountControl}}
\doxysubsubsection{\texorpdfstring{backend\_connected()}{backend\_connected()}}
{\footnotesize\ttfamily  bool klyqa\+\_\+ctl.\+account\+\_\+control.\+Account\+Control.\+backend\+\_\+connected (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{136     \textcolor{keyword}{def }backend\_connected(self) -\/> bool:}
\DoxyCodeLine{137         \textcolor{keywordflow}{return} \textcolor{keywordflow}{not} self.cloud\_backend \textcolor{keywordflow}{or} self.cloud\_backend.access\_token != \textcolor{stringliteral}{"{}"{}}}
\DoxyCodeLine{138 }

\end{DoxyCode}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classklyqa__ctl_1_1account__control_1_1AccountControl_a8938cb44ea82c6687990f061dd99828e_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classklyqa__ctl_1_1account__control_1_1AccountControl_afa68c76beee57c491239d9184cd32167}\label{classklyqa__ctl_1_1account__control_1_1AccountControl_afa68c76beee57c491239d9184cd32167}} 
\index{klyqa\_ctl.account\_control.AccountControl@{klyqa\_ctl.account\_control.AccountControl}!load\_username\_cache@{load\_username\_cache}}
\index{load\_username\_cache@{load\_username\_cache}!klyqa\_ctl.account\_control.AccountControl@{klyqa\_ctl.account\_control.AccountControl}}
\doxysubsubsection{\texorpdfstring{load\_username\_cache()}{load\_username\_cache()}}
{\footnotesize\ttfamily  None klyqa\+\_\+ctl.\+account\+\_\+control.\+Account\+Control.\+load\+\_\+username\+\_\+cache (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{164     async \textcolor{keyword}{def }load\_username\_cache(self) -\/> None:}
\DoxyCodeLine{165         acc\_settings\_cache, cached = await \mbox{\hyperlink{namespaceklyqa__ctl_1_1general_1_1general_aa34dc716ff5492dc4f325a2ae1a73a4f}{async\_json\_cache}}(}
\DoxyCodeLine{166             \textcolor{keywordtype}{None}, \textcolor{stringliteral}{"{}last.acc\_settings.cache.json"{}}}
\DoxyCodeLine{167         )}
\DoxyCodeLine{168 }
\DoxyCodeLine{169         self.account.username\_cached = cached}
\DoxyCodeLine{170 }
\DoxyCodeLine{171         \textcolor{keywordflow}{if} cached:}
\DoxyCodeLine{172             LOGGER.info(f\textcolor{stringliteral}{"{}No username or no password given using cache."{}})}
\DoxyCodeLine{173             \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} acc\_settings\_cache \textcolor{keywordflow}{or} (}
\DoxyCodeLine{174                 self.account.username}
\DoxyCodeLine{175                 \textcolor{keywordflow}{and} list(acc\_settings\_cache.keys())[0] != self.account.username}
\DoxyCodeLine{176             ):}
\DoxyCodeLine{177                 e = (}
\DoxyCodeLine{178                     \textcolor{stringliteral}{"{}Account settings are from another account than"{}}}
\DoxyCodeLine{179                     f\textcolor{stringliteral}{"{} \{self.account.username\}."{}}}
\DoxyCodeLine{180                 )}
\DoxyCodeLine{181                 LOGGER.error(e)}
\DoxyCodeLine{182                 \textcolor{keywordflow}{raise} ValueError(e)}
\DoxyCodeLine{183             \textcolor{keywordflow}{else}:}
\DoxyCodeLine{184                 \textcolor{keywordflow}{try}:}
\DoxyCodeLine{185                     self.account.username = list(acc\_settings\_cache.keys())[0]}
\DoxyCodeLine{186                     self.account.password = acc\_settings\_cache[}
\DoxyCodeLine{187                         self.account.username}
\DoxyCodeLine{188                     ][\textcolor{stringliteral}{"{}password"{}}]}
\DoxyCodeLine{189                     e = (}
\DoxyCodeLine{190                         \textcolor{stringliteral}{"{}Using cache account settings from account"{}}}
\DoxyCodeLine{191                         f\textcolor{stringliteral}{"{} \{self.account.username\}."{}}}
\DoxyCodeLine{192                     )}
\DoxyCodeLine{193                     LOGGER.info(e)}
\DoxyCodeLine{194                 \textcolor{keywordflow}{except}:}
\DoxyCodeLine{195                     e = f\textcolor{stringliteral}{"{}Could not load cached account settings."{}}}
\DoxyCodeLine{196                     LOGGER.error(e)}
\DoxyCodeLine{197                     \textcolor{keywordflow}{raise} ValueError(e)}
\DoxyCodeLine{198         \textcolor{keywordflow}{else}:}
\DoxyCodeLine{199             e = f\textcolor{stringliteral}{"{}Could not load cached account settings."{}}}
\DoxyCodeLine{200             LOGGER.error(e)}
\DoxyCodeLine{201             \textcolor{keywordflow}{raise} ValueError(e)}
\DoxyCodeLine{202 }

\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classklyqa__ctl_1_1account__control_1_1AccountControl_afa68c76beee57c491239d9184cd32167_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classklyqa__ctl_1_1account__control_1_1AccountControl_abec04a28ae718f252e846b0c05645e65}\label{classklyqa__ctl_1_1account__control_1_1AccountControl_abec04a28ae718f252e846b0c05645e65}} 
\index{klyqa\_ctl.account\_control.AccountControl@{klyqa\_ctl.account\_control.AccountControl}!login\_cache@{login\_cache}}
\index{login\_cache@{login\_cache}!klyqa\_ctl.account\_control.AccountControl@{klyqa\_ctl.account\_control.AccountControl}}
\doxysubsubsection{\texorpdfstring{login\_cache()}{login\_cache()}}
{\footnotesize\ttfamily  bool klyqa\+\_\+ctl.\+account\+\_\+control.\+Account\+Control.\+login\+\_\+cache (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}

\begin{DoxyVerb}Login cache.\end{DoxyVerb}
 
\begin{DoxyCode}{0}
\DoxyCodeLine{66     async \textcolor{keyword}{def }login\_cache(self) -\/> bool:}
\DoxyCodeLine{67         \textcolor{stringliteral}{"{}"{}"{}Login cache."{}"{}"{}}}
\DoxyCodeLine{68 }
\DoxyCodeLine{69         \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} self.account.username:}
\DoxyCodeLine{70             \textcolor{keywordflow}{try}:}
\DoxyCodeLine{71                 user\_name\_cache: dict}
\DoxyCodeLine{72                 cached: bool}
\DoxyCodeLine{73                 user\_name\_cache, cached = await \mbox{\hyperlink{namespaceklyqa__ctl_1_1general_1_1general_aa34dc716ff5492dc4f325a2ae1a73a4f}{async\_json\_cache}}(}
\DoxyCodeLine{74                     \textcolor{keywordtype}{None}, f\textcolor{stringliteral}{"{}last\_username.json"{}}}
\DoxyCodeLine{75                 )}
\DoxyCodeLine{76                 \textcolor{keywordflow}{if} cached:}
\DoxyCodeLine{77                     self.account.username = user\_name\_cache[\textcolor{stringliteral}{"{}username"{}}]}
\DoxyCodeLine{78                     LOGGER.info(}
\DoxyCodeLine{79                         \textcolor{stringliteral}{"{}Using Klyqa account \%s."{}}, self.account.username}
\DoxyCodeLine{80                     )}
\DoxyCodeLine{81                 \textcolor{keywordflow}{else}:}
\DoxyCodeLine{82                     LOGGER.error(\textcolor{stringliteral}{"{}Username missing, username cache empty."{}})}
\DoxyCodeLine{83 }
\DoxyCodeLine{84                     \textcolor{keywordflow}{if} self.interactive\_prompts:}
\DoxyCodeLine{85                         self.account.username = input(}
\DoxyCodeLine{86                             \textcolor{stringliteral}{"{} Please enter your Klyqa Account username (will"{}}}
\DoxyCodeLine{87                             \textcolor{stringliteral}{"{} be cached for the script invoke): "{}}}
\DoxyCodeLine{88                         )}
\DoxyCodeLine{89                     \textcolor{keywordflow}{else}:}
\DoxyCodeLine{90                         LOGGER.info(}
\DoxyCodeLine{91                             \textcolor{stringliteral}{"{}Missing Klyqa account username. No login."{}}}
\DoxyCodeLine{92                         )}
\DoxyCodeLine{93                         \textcolor{keywordflow}{return} \textcolor{keyword}{False}}
\DoxyCodeLine{94 }
\DoxyCodeLine{95                 \textcolor{comment}{\# async with aiofiles.open(}}
\DoxyCodeLine{96                 \textcolor{comment}{\#     os.path.dirname(sys.argv[0]) + f"{}/last\_username"{}, mode="{}r"{}}}
\DoxyCodeLine{97                 \textcolor{comment}{\# ) as f:}}
\DoxyCodeLine{98                 \textcolor{comment}{\#     self.account.username = str(await f.readline()).strip()}}
\DoxyCodeLine{99             \textcolor{keywordflow}{except}:}
\DoxyCodeLine{100                 \textcolor{keywordflow}{return} \textcolor{keyword}{False}}
\DoxyCodeLine{101 }
\DoxyCodeLine{102         \textcolor{keywordflow}{try}:}
\DoxyCodeLine{103             acc\_settings: dict}
\DoxyCodeLine{104             cached: bool}
\DoxyCodeLine{105             acc\_settings, cached = await \mbox{\hyperlink{namespaceklyqa__ctl_1_1general_1_1general_aa34dc716ff5492dc4f325a2ae1a73a4f}{async\_json\_cache}}(}
\DoxyCodeLine{106                 \textcolor{keywordtype}{None}, f\textcolor{stringliteral}{"{}\{self.account.username\}.acc\_settings.cache.json"{}}}
\DoxyCodeLine{107             )}
\DoxyCodeLine{108             \textcolor{keywordflow}{if} cached:}
\DoxyCodeLine{109                 self.acc\_settings = acc\_settings}
\DoxyCodeLine{110                 \textcolor{comment}{\# self.account.username, self.account.password = (user\_acc\_cache["{}user"{}], user\_acc\_cache["{}password"{}])}}
\DoxyCodeLine{111                 \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} self.account.password:}
\DoxyCodeLine{112                     self.account.password = self.acc\_settings[\textcolor{stringliteral}{"{}password"{}}]}
\DoxyCodeLine{113 }
\DoxyCodeLine{114             \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} self.account.password:}
\DoxyCodeLine{115                 \textcolor{keywordflow}{raise} \mbox{\hyperlink{classException}{Exception}}()}
\DoxyCodeLine{116 }
\DoxyCodeLine{117             \textcolor{comment}{\# async with aiofiles.open(}}
\DoxyCodeLine{118             \textcolor{comment}{\#     os.path.dirname(sys.argv[0]) + f"{}/last\_username"{}, mode="{}r"{}}}
\DoxyCodeLine{119             \textcolor{comment}{\# ) as f:}}
\DoxyCodeLine{120             \textcolor{comment}{\#     self.account.username = str(await f.readline()).strip()}}
\DoxyCodeLine{121         \textcolor{keywordflow}{except}:}
\DoxyCodeLine{122             \textcolor{keywordflow}{if} self.interactive\_prompts:}
\DoxyCodeLine{123                 self.account.password = getpass.getpass(}
\DoxyCodeLine{124                     prompt=(}
\DoxyCodeLine{125                         \textcolor{stringliteral}{"{} Please enter your Klyqa Account password (will be"{}}}
\DoxyCodeLine{126                         \textcolor{stringliteral}{"{} saved): "{}}}
\DoxyCodeLine{127                     ),}
\DoxyCodeLine{128                     stream=\textcolor{keywordtype}{None},}
\DoxyCodeLine{129                 )}
\DoxyCodeLine{130             \textcolor{keywordflow}{else}:}
\DoxyCodeLine{131                 LOGGER.error(\textcolor{stringliteral}{"{}Missing Klyqa account password. Login failed."{}})}
\DoxyCodeLine{132                 \textcolor{keywordflow}{return} \textcolor{keyword}{False}}
\DoxyCodeLine{133 }
\DoxyCodeLine{134         \textcolor{keywordflow}{return} \textcolor{keyword}{True}}
\DoxyCodeLine{135 }

\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classklyqa__ctl_1_1account__control_1_1AccountControl_abec04a28ae718f252e846b0c05645e65_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classklyqa__ctl_1_1account__control_1_1AccountControl_ab038bdf3bd58106dd61718ed6bb2625c}\label{classklyqa__ctl_1_1account__control_1_1AccountControl_ab038bdf3bd58106dd61718ed6bb2625c}} 
\index{klyqa\_ctl.account\_control.AccountControl@{klyqa\_ctl.account\_control.AccountControl}!request\_account\_settings@{request\_account\_settings}}
\index{request\_account\_settings@{request\_account\_settings}!klyqa\_ctl.account\_control.AccountControl@{klyqa\_ctl.account\_control.AccountControl}}
\doxysubsubsection{\texorpdfstring{request\_account\_settings()}{request\_account\_settings()}}
{\footnotesize\ttfamily  None klyqa\+\_\+ctl.\+account\+\_\+control.\+Account\+Control.\+request\+\_\+account\+\_\+settings (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}

\begin{DoxyVerb}Request the account settings from the cloud backend.\end{DoxyVerb}
 
\begin{DoxyCode}{0}
\DoxyCodeLine{55     async \textcolor{keyword}{def }request\_account\_settings(self) -\/> None:}
\DoxyCodeLine{56         \textcolor{stringliteral}{"{}"{}"{}Request the account settings from the cloud backend."{}"{}"{}}}
\DoxyCodeLine{57         \textcolor{keywordflow}{try}:}
\DoxyCodeLine{58             acc\_settings: dict[}
\DoxyCodeLine{59                 str, Any}
\DoxyCodeLine{60             ] | \textcolor{keywordtype}{None} = await self.cloud\_backend.request(\textcolor{stringliteral}{"{}settings"{}})}
\DoxyCodeLine{61             \textcolor{keywordflow}{if} acc\_settings:}
\DoxyCodeLine{62                 self.acc\_settings = acc\_settings}
\DoxyCodeLine{63         \textcolor{keywordflow}{except}:}
\DoxyCodeLine{64             \mbox{\hyperlink{namespaceklyqa__ctl_1_1general_1_1general_ad6b753e482e539892c57f8144cf213cb}{task\_log\_trace\_ex}}()}
\DoxyCodeLine{65 }

\end{DoxyCode}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classklyqa__ctl_1_1account__control_1_1AccountControl_ab038bdf3bd58106dd61718ed6bb2625c_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classklyqa__ctl_1_1account__control_1_1AccountControl_a2d4985456f595ebe24598fd360d19bae}\label{classklyqa__ctl_1_1account__control_1_1AccountControl_a2d4985456f595ebe24598fd360d19bae}} 
\index{klyqa\_ctl.account\_control.AccountControl@{klyqa\_ctl.account\_control.AccountControl}!request\_account\_settings\_eco@{request\_account\_settings\_eco}}
\index{request\_account\_settings\_eco@{request\_account\_settings\_eco}!klyqa\_ctl.account\_control.AccountControl@{klyqa\_ctl.account\_control.AccountControl}}
\doxysubsubsection{\texorpdfstring{request\_account\_settings\_eco()}{request\_account\_settings\_eco()}}
{\footnotesize\ttfamily  bool klyqa\+\_\+ctl.\+account\+\_\+control.\+Account\+Control.\+request\+\_\+account\+\_\+settings\+\_\+eco (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{int }]{scan\+\_\+interval = {\ttfamily 60} }\end{DoxyParamCaption})}

\begin{DoxyVerb}Request the account settings from the cloud backend only within a scan interval.\end{DoxyVerb}
 
\begin{DoxyCode}{0}
\DoxyCodeLine{38     ) -\/> bool:}
\DoxyCodeLine{39         \textcolor{stringliteral}{"{}"{}"{}Request the account settings from the cloud backend only within a scan interval."{}"{}"{}}}
\DoxyCodeLine{40         \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} await self.account.\_\_settings\_lock.acquire():}
\DoxyCodeLine{41             \textcolor{keywordflow}{return} \textcolor{keyword}{False}}
\DoxyCodeLine{42         ret: bool = \textcolor{keyword}{True}}
\DoxyCodeLine{43         \textcolor{keywordflow}{try}:}
\DoxyCodeLine{44             now: datetime.datetime = datetime.datetime.now()}
\DoxyCodeLine{45             \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} self.account.\_settings\_loaded\_ts \textcolor{keywordflow}{or} (}
\DoxyCodeLine{46                 now -\/ self.account.\_settings\_loaded\_ts}
\DoxyCodeLine{47                 >= datetime.timedelta(seconds=scan\_interval)}
\DoxyCodeLine{48             ):}
\DoxyCodeLine{49                 \textcolor{stringliteral}{"{}"{}"{}look that the settings are loaded only once in the scan interval"{}"{}"{}}}
\DoxyCodeLine{50                 await self.request\_account\_settings()}
\DoxyCodeLine{51         \textcolor{keywordflow}{finally}:}
\DoxyCodeLine{52             self.account.\_\_settings\_lock.release()}
\DoxyCodeLine{53         \textcolor{keywordflow}{return} ret}
\DoxyCodeLine{54 }

\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classklyqa__ctl_1_1account__control_1_1AccountControl_a2d4985456f595ebe24598fd360d19bae_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classklyqa__ctl_1_1account__control_1_1AccountControl_a6f7cdf57ee8b48970fe2554d7c1b9694}\label{classklyqa__ctl_1_1account__control_1_1AccountControl_a6f7cdf57ee8b48970fe2554d7c1b9694}} 
\index{klyqa\_ctl.account\_control.AccountControl@{klyqa\_ctl.account\_control.AccountControl}!shutdown@{shutdown}}
\index{shutdown@{shutdown}!klyqa\_ctl.account\_control.AccountControl@{klyqa\_ctl.account\_control.AccountControl}}
\doxysubsubsection{\texorpdfstring{shutdown()}{shutdown()}}
{\footnotesize\ttfamily  None klyqa\+\_\+ctl.\+account\+\_\+control.\+Account\+Control.\+shutdown (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}

\begin{DoxyVerb}Logout again from klyqa account.\end{DoxyVerb}
 
\begin{DoxyCode}{0}
\DoxyCodeLine{203     async \textcolor{keyword}{def }shutdown(self) -\/> None:}
\DoxyCodeLine{204         \textcolor{stringliteral}{"{}"{}"{}Logout again from klyqa account."{}"{}"{}}}
\DoxyCodeLine{205 }
\DoxyCodeLine{206         await self.local\_communicator.shutdown()}

\end{DoxyCode}
\mbox{\Hypertarget{classklyqa__ctl_1_1account__control_1_1AccountControl_a46d51f33622ad0e952a66d0d1b91eb12}\label{classklyqa__ctl_1_1account__control_1_1AccountControl_a46d51f33622ad0e952a66d0d1b91eb12}} 
\index{klyqa\_ctl.account\_control.AccountControl@{klyqa\_ctl.account\_control.AccountControl}!update\_device\_configs@{update\_device\_configs}}
\index{update\_device\_configs@{update\_device\_configs}!klyqa\_ctl.account\_control.AccountControl@{klyqa\_ctl.account\_control.AccountControl}}
\doxysubsubsection{\texorpdfstring{update\_device\_configs()}{update\_device\_configs()}}
{\footnotesize\ttfamily  None klyqa\+\_\+ctl.\+account\+\_\+control.\+Account\+Control.\+update\+\_\+device\+\_\+configs (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}

\begin{DoxyVerb}Request the account settings from the cloud backend.\end{DoxyVerb}
 
\begin{DoxyCode}{0}
\DoxyCodeLine{139     async \textcolor{keyword}{def }update\_device\_configs(self) -\/> None:}
\DoxyCodeLine{140         \textcolor{stringliteral}{"{}"{}"{}Request the account settings from the cloud backend."{}"{}"{}}}
\DoxyCodeLine{141 }
\DoxyCodeLine{142         product\_ids: set[str] = \{}
\DoxyCodeLine{143             ident.product\_id}
\DoxyCodeLine{144             \textcolor{keywordflow}{for} uid, device \textcolor{keywordflow}{in} self.devices.items()}
\DoxyCodeLine{145             \textcolor{keywordflow}{if} device.ident \textcolor{keywordflow}{and} ident.product\_id}
\DoxyCodeLine{146         \}}
\DoxyCodeLine{147 }
\DoxyCodeLine{148         \textcolor{keywordflow}{for} product\_id \textcolor{keywordflow}{in} list(product\_ids):}
\DoxyCodeLine{149             \textcolor{keywordflow}{if} self.device\_configs \textcolor{keywordflow}{and} product\_id \textcolor{keywordflow}{in} self.device\_configs:}
\DoxyCodeLine{150                 \textcolor{keywordflow}{continue}}
\DoxyCodeLine{151             \mbox{\hyperlink{namespaceklyqa__ctl_1_1general_1_1general_a1afe30a73cc28a3b65babeeab27e36c8}{task\_log\_debug}}(\textcolor{stringliteral}{"{}Try to request device config from server."{}})}
\DoxyCodeLine{152             \textcolor{keywordflow}{try}:}
\DoxyCodeLine{153                 config: TypeJSON | \textcolor{keywordtype}{None} = await self.cloud\_backend.request(}
\DoxyCodeLine{154                     \textcolor{stringliteral}{"{}config/product/"{}} + product\_id,}
\DoxyCodeLine{155                     timeout=30,}
\DoxyCodeLine{156                 )}
\DoxyCodeLine{157                 device\_config: Device\_config | \textcolor{keywordtype}{None} = config}
\DoxyCodeLine{158                 \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} isinstance(self.device\_configs, dict):}
\DoxyCodeLine{159                     self.device\_configs: dict[str, Any] = \{\}}
\DoxyCodeLine{160                 self.device\_configs[product\_id] = device\_config}
\DoxyCodeLine{161             \textcolor{keywordflow}{except}:}
\DoxyCodeLine{162                 \mbox{\hyperlink{namespaceklyqa__ctl_1_1general_1_1general_ad6b753e482e539892c57f8144cf213cb}{task\_log\_trace\_ex}}()}
\DoxyCodeLine{163 }

\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classklyqa__ctl_1_1account__control_1_1AccountControl_a46d51f33622ad0e952a66d0d1b91eb12_cgraph}
\end{center}
\end{figure}


\doxysubsection{Member Data Documentation}
\mbox{\Hypertarget{classklyqa__ctl_1_1account__control_1_1AccountControl_a08b89c3d1c25eb8e2e4a58151703d26e}\label{classklyqa__ctl_1_1account__control_1_1AccountControl_a08b89c3d1c25eb8e2e4a58151703d26e}} 
\index{klyqa\_ctl.account\_control.AccountControl@{klyqa\_ctl.account\_control.AccountControl}!acc\_settings@{acc\_settings}}
\index{acc\_settings@{acc\_settings}!klyqa\_ctl.account\_control.AccountControl@{klyqa\_ctl.account\_control.AccountControl}}
\doxysubsubsection{\texorpdfstring{acc\_settings}{acc\_settings}}
{\footnotesize\ttfamily klyqa\+\_\+ctl.\+account\+\_\+control.\+Account\+Control.\+acc\+\_\+settings}



The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{account__control_8py}{account\+\_\+control.\+py}}\end{DoxyCompactItemize}
